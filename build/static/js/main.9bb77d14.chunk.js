(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{52:function(e,t,c){},53:function(e,t,c){},54:function(e,t,c){},65:function(e,t,c){},66:function(e,t,c){},67:function(e,t,c){},68:function(e,t,c){"use strict";c.r(t);var a=c(5),n=c(2),s=c.n(n),i=c(25),r=c.n(i),o=(c(52),c(14)),d=(c(53),c(83)),j=(c(54),c(27)),l=j.a.initializeApp({apiKey:"AIzaSyCIZ3SPTPHGrCvPT6po_DnjxQZMUfmp9G8",authDomain:"whats-app-clone-2663b.firebaseapp.com",projectId:"whats-app-clone-2663b",storageBucket:"whats-app-clone-2663b.appspot.com",messagingSenderId:"528735119284",appId:"1:528735119284:web:281bae4228834b0c9674e1",measurementId:"G-H5PF5N488P"}).firestore(),u=j.a.auth(),b=new j.a.auth.GoogleAuthProvider,h=l,m=c(28);var O=function(e){var t,c=e.id,s=e.name,i=e.addNewChat,r=Object(n.useState)(""),j=Object(o.a)(r,2),l=j[0],u=j[1],b=Object(n.useState)(""),O=Object(o.a)(b,2),p=O[0],f=O[1];return Object(n.useEffect)((function(){c&&h.collection("rooms").doc(c).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))}))}),[c]),Object(n.useEffect)((function(){u(Math.floor(5e3*Math.random()))}),[]),i?Object(a.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat room");e&&h.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(a.jsx)("h2",{children:"Add new chat"})}):Object(a.jsx)(m.b,{to:"/rooms/".concat(c),children:Object(a.jsxs)("div",{className:"sidebarChat",children:[Object(a.jsx)(d.a,{src:"https://avatars.dicebear.com/api/human/".concat(l,".svg")}),Object(a.jsxs)("div",{className:"sidebarChat-info",children:[Object(a.jsx)("h2",{children:s}),Object(a.jsx)("p",{children:null===(t=p[0])||void 0===t?void 0:t.message})]})]})})},p=Object(n.createContext)(),f=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(a.jsx)(p.Provider,{value:Object(n.useReducer)(t,c),children:s})},v=function(){return Object(n.useContext)(p)};c(65);var x=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),c=t[0],s=t[1],i=v(),r=Object(o.a)(i,2),j=r[0].user;return r[1],Object(n.useEffect)((function(){var e=h.collection("rooms").onSnapshot((function(e){return s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(a.jsxs)("div",{className:"sidebar",children:[Object(a.jsx)("div",{className:"sidebar-header",children:Object(a.jsx)(d.a,{src:null===j||void 0===j?void 0:j.photoURL})}),Object(a.jsxs)("div",{className:"sidebar-chats",children:[Object(a.jsx)(O,{addNewChat:!0}),c.map((function(e){return Object(a.jsx)(O,{id:e.id,name:e.data.name},e.id)}))]})]})},g=(c(66),c(10));var S=function(){var e,t,c=Object(g.f)().roomId,s=Object(n.useState)(""),i=Object(o.a)(s,2),r=i[0],l=i[1],u=Object(n.useState)(""),b=Object(o.a)(u,2),m=b[0],O=b[1],p=Object(n.useState)(""),f=Object(o.a)(p,2),x=f[0],S=f[1],N=Object(n.useState)([]),C=Object(o.a)(N,2),w=C[0],y=C[1],I=v(),P=Object(o.a)(I,2),T=P[0].user;return P[1],Object(n.useEffect)((function(){c&&(h.collection("rooms").doc(c).onSnapshot((function(e){return l(e.data().name)})),h.collection("rooms").doc(c).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return y(e.docs.map((function(e){return e.data()})))})))}),[c]),Object(n.useEffect)((function(){S(Math.floor(5e3*Math.random()))}),[c]),Object(a.jsxs)("div",{className:"chat",children:[Object(a.jsxs)("div",{className:"chat-header",children:[Object(a.jsx)(d.a,{src:"https://avatars.dicebear.com/api/human/".concat(x,".svg")}),Object(a.jsxs)("div",{className:"chat-header-info",children:[Object(a.jsx)("h3",{children:r}),Object(a.jsxs)("p",{children:["Last seen ","",new Date(null===(e=w[w.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]})]}),Object(a.jsx)("div",{className:"chat-body",children:w.map((function(e){var t;return Object(a.jsxs)("p",{className:"chat-message ".concat(e.name===T.displayName&&"chat-reciever"),children:[Object(a.jsx)("span",{className:"chat-name",children:e.name}),e.message,Object(a.jsx)("span",{className:"chat-timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))}),Object(a.jsx)("div",{className:"chat-footer",children:Object(a.jsxs)("form",{children:[Object(a.jsx)("input",{value:m,onChange:function(e){return O(e.target.value)},type:"text",placeholder:"Type a message"}),Object(a.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),h.collection("rooms").doc(c).collection("messages").add({message:m,name:T.displayName,timestamp:j.a.firestore.FieldValue.serverTimestamp()}),O("")},children:"Send a message"})]})})]})},N=c(44),C=(c(67),c(82)),w=c(39),y="SET_USER",I=function(e,t){switch(console.log(t),t.type){case y:return Object(w.a)(Object(w.a)({},e),{},{user:t.user});default:return e}};var P=function(){var e=v(),t=Object(o.a)(e,2);Object(N.a)(t[0]);var c=t[1];return Object(a.jsx)("div",{className:"login",children:Object(a.jsxs)("div",{className:"login-container",children:[Object(a.jsx)("div",{className:"login-text",children:Object(a.jsx)("h1",{children:"Sign in to Chat App"})}),Object(a.jsx)(C.a,{onClick:function(){u.signInWithPopup(b).then((function(e){c({type:y,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with google"})]})})};var T=function(){var e=v(),t=Object(o.a)(e,2),c=t[0].user;return t[1],Object(a.jsx)("div",{className:"app",children:c?Object(a.jsx)("div",{className:"app-body",children:Object(a.jsxs)(m.a,{children:[Object(a.jsx)(x,{}),Object(a.jsxs)(g.c,{children:[Object(a.jsx)(g.a,{path:"/rooms/:roomId",children:Object(a.jsx)(S,{})}),Object(a.jsx)(g.a,{path:"/",children:Object(a.jsx)(S,{})})]})]})}):Object(a.jsx)(P,{})})},D=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,84)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,i=t.getTTFB;c(e),a(e),n(e),s(e),i(e)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(f,{initialState:{user:null},reducer:I,children:Object(a.jsx)(T,{})})}),document.getElementById("root")),D()}},[[68,1,2]]]);
//# sourceMappingURL=main.9bb77d14.chunk.js.map